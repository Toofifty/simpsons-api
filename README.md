# Simpsons Gif Generator API

"The Simpsons" quote API and gif generator.

[simpsons-api.matho.me](https://simpsons-api.matho.me/gif?term=ohyoubetterbelievethatsapaddlin)

## API

### `GET` `/v1/`

Retrieve statistics about the data and snippets generated by the service.

### `GET` `/v1/search`

Perform a quick search for the search criteria across all episodes. Returns all matches along with one subtitle before and after the match.

| Option   | Required | Default | Description                                                          |
| :------- | :------: | ------- | -------------------------------------------------------------------- |
| `term`   |    ✅    |         | Text-based search term. See [Search term index](#Search_term_index). |
| `offset` |          | 0       | Pagination offset.                                                   |
| `limit`  |          | 10      | Pagination limit. Max 100                                            |

### `GET` `/v1/quote`

Identify a quote (and surrounding subtitles) matching the search criteria. Supports seasons 1-29.

| Option          | Required | Default | Description                                                                         |
| :-------------- | :------: | ------- | ----------------------------------------------------------------------------------- |
| `term`          |    ✅    |         | Text-based search term. See [Search term index](#Search_term_index).                |
| `padding`       |          | `5`     | Amount of extra subtitles to return before and after the matched quote.             |
| `season`        |          | All     | Refine search by season. Quote API supports seasons 1-29.                           |
| `episode`       |          | All     | Refine search by absolute episode number. e.g. `250` is S12E03 "Insane Clown Poppy" |
| `seasonEpisode` |          | All     | Refine search by relative episode number in its season (beginning at 1).            |
| `match`         |          | `0`     | Return a particular match by ID if there are multiple matching quotes.              |
| `snap`          |          | `false` | Return a screenshot from the beginning of the matched quote.                        |

### `GET` `/v1/context`

Get the context for a subtitle or range of subtitles. Returns a specified amount of lines before or after the target range.

| Option    | Required | Default | Description                                                             |
| :-------- | :------: | ------- | ----------------------------------------------------------------------- |
| `begin`   |    ✅    |         | Integer ID of the first subtitle to include.                            |
| `end`     |    ✅    |         | Integer ID of the last subtitle to include.                             |
| `padding` |          | `5`     | Amount of extra subtitles to return before and after the matched quote. |

### `GET` `/v1/mp4`, `/v1/gif`, `/v1/webm`

Generate a snippet of the quote matching the search criteria. Supports seasons 1-19.

| Option          |        Required         | Default | Description                                                                                                             |
| :-------------- | :---------------------: | ------- | ----------------------------------------------------------------------------------------------------------------------- |
| `term`          | ✅ (or `begin` & `end`) |         | Text-based search term. See [Search term index](#Search_term_index).                                                    |
| `begin`         |     ✅ (or `term`)      |         | Integer ID of the first subtitle to include.                                                                            |
| `end`           |     ✅ (or `term`)      |         | Integer ID of the last subtitle to include.                                                                             |
| `offset`        |                         | 0       | Time in seconds to offset the subtitles. Positive numbers will begin the gif later, negative will begin the gif sooner. |
| `extend`        |                         | 0       | Additional time to extend the gif past the duration of the subtitles.                                                   |
| `render`        |                         | `false` | Immediately return gif file. Otherwise, will return a link to the static gif.                                           |
| `substitutions` |                         |         | Substitute subtitles for custom text. See [Subtitle substitution](#Subtitle_substitution).                              |

## Search term index

Episode subtitles are indexed by removing all punctuation and spaces, then by combining all subtitles in an episode into one database column to be used as the index. Because of this, there is no need to add punctuation or spaces to search terms.

The term [`get ready, everybody. He`](`https://simpsons-api.matho.me/v1/gif?term=get%20ready,%20everybody.%20He`) is equivalent to [`getreadyeverybodyhe`](https://simpsons-api.matho.me/v1/gif?term=getreadyeverybodyhe).

![getreadyeverybodyhe](https://simpsons-api.matho.me/gif/x240sb104705e104706.gif)

Gaps can also be specified by adding `[...]` between search terms. This allows for searching across multiple different subtitles without having to specify quotes perfectly.

[`alongthelinesof[...]makehomer[...]dontmind`](https://simpsons-api.matho.me/v1/gif?term=alongthelinesof[...]makehomer[...]dontmind)

![alongthelinesof[...]makehomer[...]dontmind](https://simpsons-api.matho.me/gif/x240sb51637e51640.gif)

## Subtitle substitution

Subtitles can be replaced with custom text by using the `substitution` option when generating a snippet. Substitutions should be provided as comma-separated string lists, optionally with surrounding quotes. Each substitution will replace one line of subtitles beginning at the start of the snippet. If a substition is empty, it will remove the corresponding line completely. If a substitution is the literal `~`, that line will be skipped and will display the original line from the subtitles.

**Original**

![?term=ketchupcatsup&render=1](https://simpsons-api.matho.me/v1/gif?term=ketchupcatsup&render=1)

**`substitutions=line%20one,line%20two`**

![?term=ketchupcatsup&render=1&substitutions=line%20one,line%20two](https://simpsons-api.matho.me/v1/gif?term=ketchupcatsup&render=1&substitutions=line%20one,line%20two)

**`substitutions=~,line%20two`**

![?term=ketchupcatsup&render=1&substitutions=~,line%20two](https://simpsons-api.matho.me/v1/gif?term=ketchupcatsup&render=1&substitutions=~,line%20two)

**`substitutions=,'line,%20"two"'`**

![?term=ketchupcatsup&render=1&substitutions=,'line,%20"two"'](https://simpsons-api.matho.me/v1/gif?term=ketchupcatsup&render=1&substitutions=,'line,%20"two"')
